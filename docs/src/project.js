window.__require=function t(n,e,c){function o(s,a){if(!e[s]){if(!n[s]){var r=s.split("/");if(r=r[r.length-1],!n[r]){var u="function"==typeof __require&&__require;if(!a&&u)return u(r,!0);if(i)return i(r,!0);throw new Error("Cannot find module '"+s+"'")}}var d=e[s]={exports:{}};n[s][0].call(d.exports,function(t){return o(n[s][1][t]||t)},d,d.exports,t,n,e,c)}return e[s].exports}for(var i="function"==typeof __require&&__require,s=0;s<c.length;s++)o(c[s]);return o}({game:[function(t,n,e){"use strict";cc._RF.push(n,"ba4d4W1gYxPcrtTfiXPCm0q","game");var c=function(){function t(t,n){var e=[],c=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(c=(s=a.next()).done)&&(e.push(s.value),!n||e.length!==n);c=!0);}catch(t){o=!0,i=t}finally{try{!c&&a.return&&a.return()}finally{if(o)throw i}}return e}return function(n,e){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return t(n,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();cc.Class({extends:cc.Component,properties:{linePrefab:{default:null,type:cc.Prefab},notePrefab:{default:null,type:cc.Prefab}},onLoad:function(){cc.director.getPhysicsManager().enabled=!0,cc.director.getPhysicsManager().gravity=cc.v2(0,-3200);var t=this;cc.loader.loadRes("beatmaps/list",cc.JsonAsset,function(n,e){var c=e.json[Global.CURRENT_SONG_INDEX];cc.loader.loadRes("beatmaps/"+c+"/beatmap",cc.JsonAsset,function(n,e){cc.loader.loadRes("beatmaps/"+c+"/"+e.json.music,cc.AudioClip,function(n,c){t.lines=e.json.game.lines,t.notes=e.json.game.notes,t.lineCount=0,t.noteCount=0,t.musicId=cc.audioEngine.play(c,!1,1)})})})},update:function(t){this.musicId>=0&&(this.genLine(),this.genNote())},genLine:function(){var t=this.lines[this.lineCount];if(t)for(var n in t){var e=t[n];if(cc.audioEngine.getCurrentTime(this.musicId)>=e.offset-2){this.lineCount++;var c=cc.instantiate(this.linePrefab);c.position=e.position,c.duration=e.duration,this.node.getChildByName("lines").addChild(c)}}},genNote:function(){var t=this.notes[this.noteCount];if(t)for(var n in t){var e=t[n],o=this.getNoteInit(e.position),i=c(o,3),s=i[0],a=i[1],r=i[2];if(cc.audioEngine.getCurrentTime(this.musicId)>=e.offset-r)if(this.noteCount++,1===e.type){var u=cc.instantiate(this.notePrefab);u.musicId=this.musicId,u.offset=e.offset,u.position=s,u.getComponent(cc.RigidBody).linearVelocity=a,this.node.getChildByName("notes").addChild(u)}else e.type}else this.handleGameOver()},getNoteInit:function(t){var n=-cc.director.getPhysicsManager().gravity.y,e=cc.v2(3*t.x/4,t.y+this.node.height/4),c=e.y-t.y,o=Math.sqrt(2*c/n),i=e.y+this.node.height/2,s=Math.sqrt(2*i/n),a=(t.x-e.x)/o,r=Math.sqrt(2*n*i),u=o+s,d=t.x-a*u;return[cc.v2(d,-this.node.height/2),cc.v2(a,r),u]},handleGameOver:function(){this.musicId=-999,this.getComponent(cc.Canvas).scheduleOnce(function(){cc.audioEngine.stopAll(),cc.director.loadScene("list")},3)}}),cc._RF.pop()},{}],left:[function(t,n,e){"use strict";cc._RF.push(n,"e2573nb89pDULn/TYFH+7zC","left"),cc.Class({extends:cc.Component,onLoad:function(){this.openInput()},onDestroy:function(){this.cancelInput()},openInput:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onPress,this)},cancelInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onPress,this)},onPress:function(t){this.list.loadPreview(Global.CURRENT_SONG_INDEX-1),t.stopPropagation()}}),cc._RF.pop()},{}],line:[function(t,n,e){"use strict";cc._RF.push(n,"f6c7fGCAW5KcKS1Gen5k882","line"),cc.Class({extends:cc.Component,onLoad:function(){this.node.scale=0,this.node.runAction(cc.scaleTo(1,1).easing(cc.easeCubicActionOut())),this.node.runAction(cc.sequence(cc.fadeIn(.2),cc.fadeOut(.2),cc.fadeIn(.2),cc.fadeOut(.2),cc.fadeIn(.2))),this.scheduleOnce(function(){this.node.runAction(cc.scaleTo(.5,0).easing(cc.easeCubicActionIn()))},this.node.duration+2)}}),cc._RF.pop()},{}],list:[function(t,n,e){"use strict";cc._RF.push(n,"3db54ajR+5Dv6STlmR7PLwX","list"),window.Global={CURRENT_SONG_INDEX:0},cc.Class({extends:cc.Component,properties:{left:{default:null,type:cc.Node},right:{default:null,type:cc.Node}},loadPreview:function(t){var n=this.idList[t];if(n){cc.audioEngine.stopAll(),Global.CURRENT_SONG_INDEX=t;var e=this.node.getChildByName("background");cc.loader.loadRes("beatmaps/"+n+"/beatmap",cc.JsonAsset,function(t,c){cc.loader.loadRes("beatmaps/"+n+"/"+c.json.background,cc.SpriteFrame,function(t,n){e.opacity=0,e.runAction(cc.fadeIn(.5).easing(cc.easeCubicActionOut())),e.getComponent(cc.Sprite).spriteFrame=n}),cc.loader.loadRes("beatmaps/"+n+"/"+c.json.music,cc.AudioClip,function(t,n){cc.audioEngine.play(n,!1,1)})})}},onLoad:function(){this.left.getComponent("left").list=this,this.right.getComponent("right").list=this;var t=this;cc.loader.loadRes("beatmaps/list",cc.JsonAsset,function(n,e){t.idList=e.json,t.loadPreview(Global.CURRENT_SONG_INDEX)}),this.openInput()},onDestroy:function(){this.cancelInput()},openInput:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onPress,this)},cancelInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onPress,this)},onPress:function(t){cc.audioEngine.stopAll(),cc.director.loadScene("game"),t.stopPropagation()}}),cc._RF.pop()},{}],note:[function(t,n,e){"use strict";cc._RF.push(n,"bd055+Gxt9FOrTVpZj+cf6d","note"),cc.Class({extends:cc.Component,onLoad:function(){this.node.scale=0;var t=this.node.offset-cc.audioEngine.getCurrentTime(this.node.musicId),n=cc.scaleTo(t,1),e=this.getComponent(cc.RigidBody),c=cc.callFunc(function(){e.linearVelocity=cc.v2(0,e.linearVelocity.y)},this,e),o=cc.fadeOut(.2);this.node.runAction(cc.sequence(n,c,o)),this.openInput()},onDestroy:function(){this.cancelInput()},openInput:function(){this.node.once(cc.Node.EventType.TOUCH_START,this.onPress,this)},cancelInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onPress,this)},onPress:function(t){if(this.getComponent(cc.RigidBody).linearVelocity.y<0){this.getComponent(cc.RigidBody).linearVelocity=cc.v2(0,0);var n=cc.callFunc(function(){this.node.destroy()},this);this.node.runAction(cc.scaleTo(.1,2)),this.node.runAction(cc.sequence(cc.fadeOut(.1),n))}},update:function(t){this.node.opacity<=0&&this.node.destroy()}}),cc._RF.pop()},{}],right:[function(t,n,e){"use strict";cc._RF.push(n,"f31d2dWydtI7ZEcCs1h3Bao","right"),cc.Class({extends:cc.Component,onLoad:function(){this.openInput()},onDestroy:function(){this.cancelInput()},openInput:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.onPress,this)},cancelInput:function(){this.node.off(cc.Node.EventType.TOUCH_START,this.onPress,this)},onPress:function(t){this.list.loadPreview(Global.CURRENT_SONG_INDEX+1),t.stopPropagation()}}),cc._RF.pop()},{}]},{},["game","left","line","list","note","right"]);